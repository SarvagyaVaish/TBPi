<%- model_class = Event -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human %></h1>
</div>

<% if flash[:error] %>
  <%= flash[:error] %>
<% end %>

<% if flash[:notice] %>
  <%= flash[:notice] %>
<% end %>

<div class="row-fluid">
  <div class="span6 well">
    <h3>Add Attendee</h3>

    <%= form_for @event, :url => { :action => 'add_attendee' }, :html => { :class => 'form-horizontal' } do |f| %>
      <div class="control-group">
        <%= label_tag 'gtid', 'GTID', :class => 'control-label' %>
        <div class="controls">
          <% #TODO: Add autocomplete on gtid, and or name %>
          <%= text_field(:attendee, :gtid, :value => '902', :class => 'text_field') %>
        </div>
      </div>

      <div class="control-group">
        <%= label_tag 'points', 'Points', :class => 'control-label' %>
        <div class="controls">
          <%= text_field(:attendee, :points, :value => @event.default_points, :class => 'text_field') %>
        </div>
      </div>

      <div class="form-actions">
        <%= button_tag 'Add', :type => 'submit', :class => 'btn btn-primary' %>
      </div>
    <% end %>

  </div>

  <div class="span6 well">
    <h3>Attendees</h3>

    <% if @members.count != 0 %>
      <div class="row-fluid">
        <div class="span12">

          <table class="table table-striped">
            <thead>
              <tr>
                <th>Name</th>
                <th>GTID</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% @members.each do |member| %>
                <tr>
                  <td><%= link_to "#{member.first_name} #{member.last_name}", member_path(member) %></td>
                  <td><%= member.gtid %></td>
                  <td><%= Attendance.where(:member_id => member.id, :event_id => @event.id).first.status %></td>
                  <td><%= link_to "Remove", remove_attendee_event_path(:attendee_id => member.id), :class => 'btn btn-small' %></td>
                </tr>
              <% end %>
            </tbody>
          </table>

        </div>
      </div>
    <% else %>
      <br />
      <h5>There are currently no attendees</h5>
    <% end %>
  </div>
</div>

<div class="row-fluid">
  <div class="span6 well">
    <h3>Event Details</h3>
    <dl class="dl-horizontal">
      <dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
      <dd><%= @event.name %></dd>
      <dt><strong>Start:</strong></dt>
      <dd><%= @event.start_dt %></dd>
      <dt><strong>End:</strong></dt>
      <dd><%= @event.end_dt %></dd>
      <dt><strong><%= model_class.human_attribute_name(:event_type_id) %>:</strong></dt>
      <dd><%= EventType.find(@event.event_type_id).name %></dd>
      <dt><strong><%= model_class.human_attribute_name(:semester_id) %>:</strong></dt>
      <dd><%= Semester.find(@event.semester_id).name %></dd>
    </dl>

    <div class="form-actions">
      <%= link_to t('.back', :default => t("helpers.links.back")), events_path, :class => 'btn'  %>
      <%= link_to t('.edit', :default => t("helpers.links.edit")), edit_event_path(@event), :class => 'btn' %>
      <%= link_to t('.destroy', :default => t("helpers.links.destroy")), event_path(@event), :method => 'delete', :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')), :class => 'btn btn-danger' %>
    </div>
  </div>
</div>

